# LangChain AI Agent 學習指南

從簡單的 QA 系統到智能的財務顧問 Agent，這裡展示了完整的進化過程。

## 🎯 學習目標

透過這個教學範例，你將學會：
- 理解 RAG（檢索增強生成）的基本原理
- 如何逐步添加工具來擴展系統功能
- 如何設計和實現 AI Agent 架構
- 如何讓 Agent 智能地選擇和協調多個工具

## 📚 版本進化說明

### 版本 1：基本的財務知識庫 QA 系統
**檔案：`v1_basic_financial_qa.py`**

**特色：**
- 純粹的知識庫問答系統
- 使用向量資料庫檢索相關資訊
- 只能回答知識庫中已有的內容

**學習重點：**
- 理解 RAG 的基本架構
- 學習如何載入和處理 PDF 文件
- 掌握向量資料庫的建立和查詢

```bash
python versions/v1_basic_financial_qa.py
```

### 版本 2：財務 QA + 股票價格查詢
**檔案：`v2_financial_qa_with_stock.py`**

**新增功能：**
- 添加股票價格查詢工具
- 智能偵測用戶意圖（股票 vs 知識庫查詢）
- 結合靜態知識和即時資訊

**學習重點：**
- 如何定義和使用工具函數
- 學習意圖偵測和路由邏輯
- 理解工具與知識庫的協同工作

```bash
python versions/v2_financial_qa_with_stock.py
```

### 版本 3：財務 QA + 財經新聞查詢
**檔案：`v3_financial_qa_with_news.py`**

**新增功能：**
- 添加財經新聞查詢工具
- 多工具協調處理複雜查詢
- 支援主題特定的新聞查詢

**學習重點：**
- 多工具系統的設計原則
- 工具選擇和參數提取邏輯
- 複雜查詢的處理策略

```bash
python versions/v3_financial_qa_with_news.py
```

### 最終版本：專業財務顧問 AI Agent
**檔案：`v4_financial_ai_agent.py`**

**完整功能：**
- 專業的財務顧問 Agent
- 智能工具選擇和協調
- 多輪對話和上下文理解

**學習重點：**
- LangChain Agent 架構的實現
- 系統提示的設計藝術
- 多工具協調的最佳實務

```bash
python versions/v4_financial_ai_agent.py
```

## 🚀 快速開始

### 1. 安裝依賴
```bash
cd /Users/gloomcheng/Workspace/T-Ambassador-2025/langchain
uv sync
```

### 2. 準備知識庫文件
確保目錄中有財務相關的 PDF 文件：
```
202502_6625_AI1_20250924_142829.pdf
```

### 3. 逐步體驗每個版本

建議學習順序：
1. **先運行版本 1** - 理解基礎的 RAG 系統
2. **再運行版本 2** - 學習如何添加第一個工具
3. **體驗版本 3** - 掌握多工具協調
4. **最後運行最終版本** - 見證完整的 AI Agent

## 💡 每個版本的關鍵差異

| 版本 | 知識來源 | 工具數量 | 智能程度 | 適用場景 |
|------|----------|----------|----------|----------|
| v1 | 僅知識庫 | 0 | 基礎 | 靜態資訊查詢 |
| v2 | 知識庫+股票 | 1 | 中等 | 簡單投資查詢 |
| v3 | 知識庫+股票+新聞 | 2 | 較高 | 市場分析 |
| v4 | 知識庫+多工具 | 3+ | 最高 | 專業財務顧問 |

## 🔧 程式架構解析

### 共同元件
- **知識庫載入**：PyPDFLoader + 文本分割 + 向量資料庫
- **LLM 初始化**：ChatOllama（Gemma 3 1B 模型）
- **向量檢索**：相似度搜尋相關內容

### 進化元件
- **工具定義**：從簡單函數到 @tool 裝飾器
- **意圖偵測**：從關鍵字匹配到智能分析
- **工具協調**：從手動選擇到自動 Agent 決策

## 🎓 教學建議

### 給講師的建議

1. **循序漸進**：按照版本順序展示，避免學員混亂
2. **現場演示**：每個版本都實際運行，讓學員看到差異
3. **比較說明**：強調每個版本的進步和新功能
4. **互動練習**：讓學員嘗試修改工具或添加新功能

### 給學員的建議

1. **親自動手**：每個版本都親自運行體驗差異
2. **觀察思考過程**：注意 Agent 如何決定使用哪些工具
3. **嘗試修改**：試著調整系統提示或添加新工具
4. **理解原理**：不要只看結果，要理解背後的機制

## 🎯 核心概念解析

### 1. 從 QA 到 Agent 的轉變

**QA 系統：**
```
用戶問題 → 搜尋知識庫 → 返回答案
```

**AI Agent：**
```
用戶問題 → 分析意圖 → 選擇工具 → 協調執行 → 整合結果 → 返回答案
```

### 2. 工具的設計原則

- **專職專責**：每個工具負責一個特定功能
- **參數明確**：輸入輸出格式清晰
- **錯誤處理**：能夠優雅處理異常情況

### 3. Agent 的決策邏輯

- **意圖識別**：理解用戶真正想要什麼
- **工具選擇**：決定哪個工具最適合
- **結果整合**：將多個工具結果組合成連貫答案

## 🚨 常見問題與解答

**Q：為什麼不直接從最終版本開始？**
A：因為每個版本都展示了重要的進化步驟，讓學員理解為什麼需要這些功能。

**Q：這些工具都是模擬的嗎？**
A：是的，這是教學範例。實際應用中，你會串接真實的 API（如 Yahoo Finance、News API）。

**Q：可以添加更多工具嗎？**
A：當然可以！試著添加：
- 技術指標計算工具
- 財務報表分析工具
- 市場情緒分析工具

## 🎉 下一步學習建議

完成這個教學範例後，你可以：

1. **串接真實 API**：將模擬工具替換成真實的財務數據 API
2. **添加記憶功能**：讓 Agent 記住對話歷史和用戶偏好
3. **實現進階 Agent 架構**：嘗試 ReAct、Plan-and-Execute 等架構
4. **部署為 Web 服務**：將 Agent 打包成 API 服務供他人使用

祝學習愉快！🎊
